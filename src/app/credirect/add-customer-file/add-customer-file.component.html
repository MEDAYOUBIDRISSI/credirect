<div *ngIf="!loading && customerId && customerId !== '0'">
</div>
<div *ngIf="step != 5 && step != 6" class="card">
    <div *ngIf="step == 0" class="d-flex justify-content-center align-items-center">
        <div class="d-flex justify-content-center gap-4" style="display: flex;">
            <div 
                class="card shadow-sm"
                [class.opacity-50]="!isSelected1" 
                (click)="selectCard(1)"
                style="cursor: pointer; border-radius: 5px; padding: 1rem; width: 22rem; height: 63vh;">   
                <img 
                    alt="Card 1" 
                    class="w-100"  
                    src="assets/demo/images/galleria/entrepreneur.svg"
                    style="width: 20rem; height: 20rem;" />
                
                <div class="mt-3">
                    <p-button label="Personne Physique" [styleClass]="isSelected1 ? 'p-button-primary full-width' : 'p-button-outlined p-button-primary full-width'"></p-button>
                </div>
    
                <p class="mt-3">
                    Ajouter une personne physique : un individu identifiable qui peut être associé à des transactions ou des dossiers de crédit en son nom propre.
                </p>
            </div>
    
            <div 
                class="card shadow-sm"
                [class.opacity-50]="!isSelected2" 
                (click)="selectCard(2)"
                style="cursor: pointer; border-radius: 5px; padding: 1rem; width: 22rem; height: 63vh;">   
                <img 
                    alt="Card 2" 
                    class="w-100"  
                    src="assets/demo/images/galleria/organizer.svg"
                    style="width: 20rem; height: 20rem;" />
                
                <div class="mt-3">
                    <p-button label="Personne Morale" [styleClass]="isSelected2 ? 'p-button-primary full-width' : 'p-button-outlined p-button-primary full-width'"></p-button>
                </div>

                <p class="mt-3">
                    Ajouter une personne morale : une entité juridique, telle qu’une entreprise ou une organisation, pouvant être associée à des dossiers de crédit ou des engagements légaux.
                </p>
            </div>
        </div>
    </div>
    
    <div *ngIf="step == 1">
        <h3 class="text-lg font-bold mb-4">Veuillez sélectionner votre rôle dans la liste ci-dessous :</h3>
        <div style="display: flex; justify-content: center;" >
          <p-listbox 
            [options]="roles"
            [(ngModel)]="selectedRole" 
            optionLabel="label"
            class="w-48">
          </p-listbox>
        </div>
      </div>
    
    <div *ngIf="step == 2 || step == 3 || step == 4" >
        <p-steps [model]="items" [readonly]="true" [activeIndex]="activeIndex" (activeIndexChange)="onActiveIndexChange($event)" />
        <div class="container">
        <div class="row">
            <div class="col-12" *ngIf="activeIndex == 0">
                <div class="grid p-fluid mt-3">

                <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                    <label for="CompanyName ">Dénomination </label>
                    <input pInputText id="CompanyName " type="text" [(ngModel)]="CompanyName " placeholder="Votre Dénomination " />
                </div>
    
                <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                    <label for="forme_juridique">Forme juridique</label>
                    <p-dropdown
                      [options]="legalForms"
                      [(ngModel)]="selectedLegalForm"
                      optionLabel="label"
                      [showClear]="true"
                      placeholder="Sélectionner une forme juridique">
                    </p-dropdown>
                </div>

                <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                    <label for="CreationDate">Date de création</label>
                    <input pInputText id="CreationDate" type="date" [(ngModel)]="CreationDate" />
                </div>

                <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                    <label for="RegistrationNumber">N° RC</label>
                    <input
                    pInputText
                    id="RegistrationNumber"
                    type="text"
                    [(ngModel)]="RegistrationNumber"
                    placeholder="Votre N° RC"
                    />
                </div>

                <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                    <label for="business_activity">Activité</label>
                    <p-dropdown
                      [options]="businessActivities"
                      [(ngModel)]="selectedBusinessActivity"
                      optionLabel="label"
                      [showClear]="true"
                      placeholder="Sélectionner une activité">
                    </p-dropdown>
                </div>
                
                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="LastName">Nom</label>
                  <input pInputText id="LastName" type="text" [(ngModel)]="LastName" placeholder="Votre nom" />
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                    <label for="FirstName">Prénom</label>
                    <input pInputText id="FirstName" type="text" [(ngModel)]="FirstName" placeholder="Votre prénom" />
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                    <label for="BirthDate">Date de Naissance</label>
                    <input pInputText id="BirthDate" type="date" [(ngModel)]="BirthDate" />
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="civilite">Civilité</label>
                  <p-dropdown
                    [options]="titles"
                    [(ngModel)]="selectedTitle"
                    optionLabel="label"
                    [showClear]="true"
                    placeholder="Sélectionner">
                  </p-dropdown>
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                    <label for="Nationality">Nationalité</label>
                    <input
                    pInputText
                    id="Nationality"
                    type="text"
                    [(ngModel)]="Nationality"
                    placeholder="Votre nationalité"
                    />
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                    <label for="Email">Adresse mail</label>
                    <input
                    pInputText
                    id="Email"
                    type="Email"
                    [(ngModel)]="Email"
                    placeholder="Votre email"
                    />
                </div>

                <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="num_fiche">Identité</label>
                  <div class="flex flex-wrap gap-3">
                      <div *ngFor="let identity of identities" class="flex align-items-center">
                          <p-radioButton 
                              [inputId]="'identity_' + identity.value" 
                              name="identity" 
                              [value]="identity" 
                              [(ngModel)]="selectedIdentity" />
                          <label [for]="'identity_' + identity.value" class="ml-2">
                              {{ identity?.label }}
                          </label>
                      </div>
                  </div>
              </div>
              
              <div *ngIf="selectedIdentity?.value === 1002 && isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="CIN">CIN</label>
                  <input
                      pInputText
                      id="CIN"
                      type="text"
                      [(ngModel)]="CIN"
                      placeholder="Votre CIN"
                  />
              </div>
              
              <div *ngIf="selectedIdentity?.value === 1003 && isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="ResidencePermit">Carte Séjour</label>
                  <input
                      pInputText
                      id="ResidencePermit"
                      type="text"
                      [(ngModel)]="ResidencePermit"
                      placeholder="Votre Carte Séjour"
                  />
              </div>   
              
              <div *ngIf="selectedIdentity?.value === 1004 && isSelected1" class="field col-12 md:col-6 lg:col-4">
                  <label for="PassportNumber">Passeport</label>
                  <input
                      pInputText
                      id="PassportNumber"
                      type="text"
                      [(ngModel)]="PassportNumber"
                      placeholder="Votre Passeport"
                  />
              </div>

                </div>
            </div>
            <div class="col-12" *ngIf="activeIndex == 1">
                <div class="grid p-fluid mt-3">

                    <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                        <label for="SocialCapital">Capital social</label>
                        <input pInputText id="SocialCapital" type="text" [(ngModel)]="SocialCapital" placeholder="Votre Capital social " />
                    </div>

                    <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                        <label for="RequestedAmount">Montant sollicité </label>
                        <input pInputText id="RequestedAmount" type="text" [(ngModel)]="RequestedAmount" placeholder="Votre Montant sollicité " />
                    </div>

                    <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                        <label for="CompanyCity">Ville</label>
                        <input
                        pInputText
                        id="CompanyCity"
                        type="text"
                        [(ngModel)]="CompanyCity"
                        placeholder="Votre ville"
                        />
                    </div>

                    <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                      <label for="CompanyCountry">Pays</label>
                      <p-dropdown
                        [options]="companyCountries"
                        [(ngModel)]="selectedCompanyCountry"
                        optionLabel="label"
                        [showClear]="true"
                        placeholder="Sélectionner votre Pays">
                      </p-dropdown>
                  </div>

                    <div *ngIf="isSelected2" class="field col-12 md:col-6 lg:col-4">
                        <label for="CompanyAddress">Adresse</label>
                        <textarea
                        rows="5"
                        id="CompanyAddress"
                        pInputTextarea
                        [(ngModel)]="CompanyAddress"
                        placeholder="Votre adresse complète"
                        ></textarea>
                    </div>

                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-3">
                        <label for="City">Ville</label>
                        <input
                        pInputText
                        id="City"
                        type="text"
                        [(ngModel)]="City"
                        placeholder="Votre ville"
                        />
                    </div>

                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-3">
                      <label for="country">Pays</label>
                      <p-dropdown
                        [options]="countries"
                        [(ngModel)]="selectedCountry"
                        optionLabel="label"
                        [showClear]="true"
                        placeholder="Sélectionner votre Pays">
                      </p-dropdown>
                  </div>

                  <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-3">
                    <label for="country">Pays de Résidence</label>
                    <p-dropdown
                      [options]="residenceCountries"
                      [(ngModel)]="selectedResidenceCountry"
                      optionLabel="label"
                      [showClear]="true"
                      placeholder="Sélectionner votre Pays de Résidence">
                    </p-dropdown>
                </div>
    
                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-3">
                        <label for="situation_familiale">Situation Familiale</label>
                        <p-dropdown
                          [options]="maritalStatuses"
                          [(ngModel)]="selectedMaritalStatus"
                          optionLabel="label"
                          [showClear]="true"
                          placeholder="Sélectionner un état civil">
                        </p-dropdown>
                    </div>

                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                        <label for="MobilePhone">Téléphone Mobile</label>
                        <input
                        pInputText
                        id="MobilePhone"
                        type="text"
                        [(ngModel)]="MobilePhone"
                        placeholder="Votre Téléphone Mobile"
                        />
                    </div>

                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                        <label for="LandlinePhone">Téléphone Fixe</label>
                        <input
                        pInputText
                        id="LandlinePhone"
                        type="text"
                        [(ngModel)]="LandlinePhone"
                        placeholder="Votre Téléphone fixe"
                        />
                    </div>

                    <div *ngIf="isSelected1" class="field col-12 md:col-6 lg:col-4">
                        <label for="WorkPhone">Téléphone Professionnel</label>
                        <input
                        pInputText
                        id="WorkPhone"
                        type="text"
                        [(ngModel)]="WorkPhone"
                        placeholder="Votre Téléphone Professionnel"
                        />
                    </div>
    
                    <div *ngIf="isSelected1" class="field col-12">
                        <label for="Address">Adresse</label>
                        <textarea
                        rows="5"
                        id="Address"
                        pInputTextarea
                        [(ngModel)]="Address"
                        placeholder="Votre adresse complète"
                        ></textarea>
                    </div>
    
                    </div>
            </div>
            <div class="col-12" *ngIf="activeIndex == 2">
                <div *ngIf="isSelected2" class="grid p-fluid mt-3">

                  <div *ngFor="let manager of managers; let i = index" class="manager-item card">
                    <div class="grid">
                      <h4 class="col-12">Manager {{ i + 1 }}</h4>
                      
                      <!-- Last Name -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerLastName' + i">Nom</label>
                        <input pInputText [id]="'ManagerLastName' + i" type="text"
                               [(ngModel)]="manager.ManagerLastName" />
                      </div>
                      
                      <!-- First Name -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerFirstName' + i">Prénom</label>
                        <input pInputText [id]="'ManagerFirstName' + i" type="text"
                               [(ngModel)]="manager.ManagerFirstName" />
                      </div>
                      
                      <!-- Birth Date -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerBirthDate' + i">Date de Naissance</label>
                        <input pInputText [id]="'ManagerBirthDate' + i" type="date"
                               [(ngModel)]="manager.ManagerBirthDate" />
                      </div>
                      
                      <!-- Title -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerTitleID' + i">Civilité</label>
                        <p-dropdown [id]="'ManagerTitleID' + i"
                          [options]="titles"
                          [(ngModel)]="manager.ManagerTitleID"
                          optionLabel="label"
                          [showClear]="true"
                          placeholder="Sélectionner">
                        </p-dropdown>
                        <!-- <p-dropdown [id]="'ManagerTitleID' + i" [options]="civilites"
                                   [(ngModel)]="manager.ManagerTitleID" optionLabel="label"
                                   optionValue="value"></p-dropdown> -->
                      </div>
                      
                      <!-- Nationality -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerNationality' + i">Nationalité</label>
                        <input pInputText [id]="'ManagerNationality' + i" type="text"
                               [(ngModel)]="manager.ManagerNationality" />
                      </div>
                      
                      <!-- Identity Type -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label>Identité</label>
                        <div class="flex flex-wrap gap-3">
                          <div *ngFor="let identity of identities2" class="flex align-items-center">
                            <p-radioButton [inputId]="identity.key + i" name="Id_Identity{{i}}"
                                          [value]="identity" [(ngModel)]="manager.Id_Identity" />
                            <label [for]="identity.key + i" class="ml-2">{{ identity.name }}</label>
                          </div>
                        </div>
                      </div>
                      
                      <!-- Identity Documents (dynamic based on selection) -->
                      <div *ngIf="manager.Id_Identity?.key === 'A'" class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'CIN' + i">CIN</label>
                        <input pInputText [id]="'CIN' + i" type="text" [(ngModel)]="manager.CIN" />
                      </div>
                      
                      <div *ngIf="manager.Id_Identity?.key === 'B'" class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'CarteSejour' + i">Carte Séjour</label>
                        <input pInputText [id]="'CarteSejour' + i" type="text" [(ngModel)]="manager.CarteSejour" />
                      </div>
                      
                      <div *ngIf="manager.Id_Identity?.key === 'C'" class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'Passeport' + i">Passeport</label>
                        <input pInputText [id]="'Passeport' + i" type="text" [(ngModel)]="manager.Passeport" />
                      </div>
                      
                      <!-- Marital Status -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'Id_ManagerMaritalStatus' + i">Situation Familiale</label>
                        <p-dropdown [id]="'Id_ManagerMaritalStatus' + i"
                          [options]="maritalStatuses"
                          [(ngModel)]="manager.Id_ManagerMaritalStatus"
                          optionLabel="label"
                          [showClear]="true"
                          placeholder="Sélectionner un état civil">
                        </p-dropdown>
                        <!-- <p-dropdown [id]="'Id_ManagerMaritalStatus' + i" [options]="situations_familiales"
                                   [(ngModel)]="manager.Id_ManagerMaritalStatus" optionLabel="label"
                                   optionValue="value"></p-dropdown> -->
                      </div>
                      
                      <!-- City -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerCity' + i">Ville</label>
                        <input pInputText [id]="'ManagerCity' + i" type="text"
                               [(ngModel)]="manager.ManagerCity" />
                      </div>
                      
                      <!-- Country -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerCountryID' + i">Pays</label>
                        <p-dropdown [id]="'ManagerCountryID' + i"
                        [options]="countries"
                        [(ngModel)]="manager.ManagerCountryID"
                        optionLabel="label"
                        [showClear]="true"
                        placeholder="Sélectionner votre Pays">
                      </p-dropdown>
                        <!-- <p-dropdown [id]="'ManagerCountryID' + i" [options]="countries"
                                   [(ngModel)]="manager.ManagerCountryID" optionLabel="label"
                                   optionValue="value"></p-dropdown> -->
                      </div>
                      
                      <!-- Residence Country -->
                      <div class="field col-12 md:col-6 lg:col-4">
                        <label [for]="'ManagerResidenceCountryID' + i">Pays de Résidence</label>
                        <p-dropdown [id]="'ManagerResidenceCountryID' + i"
                          [options]="residenceCountries"
                          [(ngModel)]="manager.ManagerResidenceCountryID"
                          optionLabel="label"
                          [showClear]="true"
                          placeholder="Sélectionner votre Pays de Résidence">
                        </p-dropdown>
                        <!-- <p-dropdown [id]="'ManagerResidenceCountryID' + i" [options]="countries"
                                   [(ngModel)]="manager.ManagerResidenceCountryID" optionLabel="label"
                                   optionValue="value"></p-dropdown> -->
                      </div>
                      
                      <!-- Address -->
                      <div class="field col-12">
                        <label [for]="'ManagerAddress' + i">Adresse</label>
                        <textarea [id]="'ManagerAddress' + i" pInputTextarea rows="3"
                                 [(ngModel)]="manager.ManagerAddress"></textarea>
                      </div>
                    </div>
                    
                    <!-- Delete Button -->
                    <button *ngIf="i > 0" pButton type="button" label="Supprimer" icon="pi pi-trash"
                            class="p-button-danger p-mt-2" (click)="removeManager(i)"></button>
                  </div>

                      <!-- Add Manager Button -->
                        <button *ngIf="isSelected2"
                        pButton
                        type="button"
                        label="Ajouter un Manager"
                        icon="pi pi-plus"
                        class="p-button-primary"
                        (click)="addManager()"
                        ></button>
                        </div>
                        <div *ngIf="isSelected1" class="grid p-fluid mt-3">
                        <div class="field col-12 md:col-6 lg:col-4">
                          <label for="residencyStatus">Statut</label>
                          <div class="flex flex-wrap gap-3">
                              <div *ngFor="let status of residencyStatuses" class="flex align-items-center">
                                  <p-radioButton 
                                      [inputId]="'status_' + status.value" 
                                      name="residencyStatus" 
                                      [value]="status" 
                                      [(ngModel)]="selectedResidencyStatus" />
                                  <label [for]="'status_' + status.value" class="ml-2">
                                      {{ status?.label }}
                                  </label>
                              </div>
                          </div>
                      </div>

                      <div class="field col-12 md:col-6 lg:col-4">
                        <label for="num_fiche">Statut d'occupation</label>
                        <div class="flex flex-wrap gap-3">
                            <div *ngFor="let statut of statuts_Occupation" class="flex align-items-center">
                                <p-radioButton 
                                    [inputId]="statut.key" 
                                    name="Statut_Occupation" 
                                    [value]="statut" 
                                    [(ngModel)]="selectedStatut_Occupation"
                                    (ngModelChange)="updateOccupationStatus()" />
                                <label [for]="statut.key" class="ml-2">
                                    {{ statut.name }}
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <label for="RequestedAmount">Montant sollicité</label>
                        <input
                        pInputText
                        id="RequestedAmount"
                        type="text"
                        [(ngModel)]="RequestedAmount"
                        placeholder="Votre Montant sollicité "
                        />
                    </div>
    
                    <div class="field col-12 md:col-6 lg:col-4">
                        <label for="origin">Provenance du client</label>
                        <p-dropdown
                        [options]="clientOrigins"
                        [(ngModel)]="selectedClientOrigin"
                        optionLabel="label"
                        [showClear]="true"
                        placeholder="Sélectionner une origine">
                      </p-dropdown>
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <label for="OriginDetails">Détail de provenance</label>
                        <textarea
                        rows="5"
                        id="OriginDetails"
                        pInputTextarea
                        [(ngModel)]="OriginDetails"
                        placeholder="Votre Détail de provenance"
                        ></textarea>
                    </div>

                </div>
            </div>
        </div>
        </div>
    </div>

    <div class="flex space-between mt-4" style="justify-content: space-between;">
        <span *ngIf="step == 0 || step == 5"></span>
        <button *ngIf="step != 0 && step != 5"
        pButton pRipple type="button"
        class="p-button-primary" 
          label="Précédent" 
          (click)="goToPreviousStep()">
        </button>
        
        <button *ngIf="step != 4 && step != 5 && step != 0 && step != 1"
          pButton pRipple type="button"
          class="p-button-primary" 
          label="Suivant" 
          [disabled]="isNextDisabled()" 
          (click)="onNextClick()">
        </button>

        <button *ngIf="step == 0 || step == 1"
          pButton pRipple type="button"
          class="p-button-primary" 
          label="Suivant" 
          [disabled]="isNextDisabled()" 
          (click)="simple_onNextClick()">
        </button>

        <button *ngIf="step == 4"
          pButton pRipple type="button"
          class="p-button-primary" 
          label="Done" 
          [disabled]="isNextDisabled()" 
          (click)="onNextClick()">
        </button>
    </div>   
    
</div>

<div *ngIf="step == 5" class="vh-100 d-flex justify-content-center align-items-center" [style]="{'display': 'flex', 'justify-content': 'center'}">
    <div class="card text-center" [style]="{'width': 'auto', 'min-width': '300px', 'max-width': '500px'}">
        <div class="card-body">
            <h3 *ngIf="isSelected1" style="color: #f1a253;"><strong>Personne Physique</strong></h3>
            <h3 *ngIf="isSelected2" style="color: #f1a253;"><strong>Personne Morale</strong></h3>
            <p *ngIf="isSelected1" class="card-text">
                <span style="font-size: 18px; color: #333;">{{LastName}} {{FirstName}}</span> <br />
                <span style="font-size: 16px; color: #666;">{{CIN}}</span> <br />
                <span style="font-size: 16px; font-style: italic; color: #444;">{{selectedRole?.label}}</span> <br />
                <span style="font-size: 16px; color: #444;">{{City}}</span> <br />
                <span style="font-size: 16px; color: #444;">{{MobilePhone}}</span> <br />
                <a class="fs-6 text-decoration-none" style="color: #007bff;">{{Email}}</a>
            </p>

            <p *ngIf="isSelected2" class="card-text">
                <span style="font-size: 18px; color: #333;">{{CompanyName}}</span> <br />
                <span style="font-size: 16px; color: #666;">{{RegistrationNumber}}</span> <br />
                <span style="font-size: 16px; font-style: italic; color: #444;">{{selectedRole?.label}}</span> <br />
                <span style="font-size: 16px; color: #444;">{{CompanyCity}}</span> <br />
                <span style="font-size: 16px; color: #444;">{{WorkPhone}}</span> <br />
                <a class="fs-6 text-decoration-none" style="color: #007bff;">{{Email}}</a>
            </p>

            <div class="mt-3">
                <button pButton pRipple type="button" label="Modifier la fiche" class="p-button-primary" [style]="{'width': '200px'}" (click)="onEditClick()"></button>
            </div>
            <div class="mt-3">
                <button pButton pRipple type="button" label="Details" class="p-button-primary" (click)="goToNextStep()" [style]="{'width': '200px'}"></button>
            </div>
            <div class="mt-3">
                <button pButton pRipple type="button" label="Supprimer la fiche" class="p-button-primary" [style]="{'width': '200px'}" (click)="showDeleteConfirmation()"></button>
            </div>
            <div class="mt-3">
                <button pButton pRipple type="button" label="Création dossier" class="p-button-primary" [style]="{'width': '200px'}"></button>
            </div>
        </div>
    </div>
</div>

<div *ngIf="step == 6" class="grid p-fluid">
    <div class="col-12 md:col-6">
		<div class="card">
			<h3 style="color: #f1a253;"><strong>Informations générales</strong></h3>
			<div *ngIf="isSelected1" class="grid formgrid">
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Nature du tiers :</strong> Personne Physique</h5> 
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Nom - Prénom :</strong> {{LastName}} {{FirstName}}</h5>
				</div>
				<div *ngIf="selectedIdentity?.value === 1002" class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>CIN :</strong> {{CIN}}</h5>
				</div>
        <div *ngIf="selectedIdentity?.value === 1003" class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Carte Séjour :</strong> {{ResidencePermit}}</h5>
				</div>
        <div *ngIf="selectedIdentity?.value === 1004" class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Passeport :</strong> {{PassportNumber}}</h5>
				</div>
        <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Rôle du tiers :</strong> {{selectedRole?.label}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Date de Naissance :</strong> {{BirthDate}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Civilité :</strong> {{selectedTitle?.label}} </h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Nationalité :</strong> {{Nationality}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-8 lg:mb-0">
					<h5><strong>Adresse mail :</strong> {{Email}}</h5>
				</div>
			</div>
            <div *ngIf="isSelected2" class="grid formgrid">
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Nature du tiers :</strong> Personne Morale</h5> 
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Dénomination :</strong> {{CompanyName}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Forme juridique :</strong> {{selectedLegalForm?.label}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Rôle du tiers :</strong> {{selectedRole?.label}} </h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Date de Création :</strong> {{CreationDate}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>N° RC :</strong> {{RegistrationNumber}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Activité :</strong> {{selectedBusinessActivity?.label}}</h5>
				</div>
			</div>
        </div>
        <div *ngIf="isSelected1" class="card">
            <h3 style="color: #f1a253;"><strong>Zone d'implantation</strong></h3>
            <div class="grid formgrid">
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Statut :</strong> {{selectedStatut?.name}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Statut d'occupation :</strong> {{selectedStatut_Occupation?.name}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Montant sollicité :</strong> {{RequestedAmount}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Provenance du client :</strong> {{selectedClientOrigin?.label}}</h5>
				</div>
                <div class="col-12">
					<h5><strong>Détail de provenance :</strong> {{OriginDetails}}</h5>
				</div>
			</div>
        </div>
        <div *ngIf="isSelected2" class="card">
            <h3 style="color: #f1a253;"><strong>Informations détaillées</strong></h3>
            <div class="grid formgrid">
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Ville :</strong> {{CompanyCity}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Pays :</strong> {{selectedCompanyCountry?.label}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Capital social :</strong> {{SocialCapital}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Montant sollicité :</strong> {{RequestedAmount}}</h5>
				</div>
                <div class="col-12">
					<h5><strong>Adresse :</strong> {{CompanyAddress}}</h5>
				</div>
			</div>
        </div>
    </div>
    <div class="col-12 md:col-6">
        <div *ngIf="isSelected1" class="card">
            <h3 style="color: #f1a253;"><strong>Informations détaillées</strong></h3>
            <div class="grid formgrid">
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Ville :</strong> {{City}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Pays :</strong> {{selectedCountry?.label}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Pays de Résidence :</strong> {{selectedResidenceCountry?.label}}</h5>
				</div>
				<div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Situation familiale :</strong> {{selectedMaritalStatus?.label}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Téléphone mobile :</strong> {{MobilePhone}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Téléphone fixe :</strong> {{LandlinePhone}}</h5>
				</div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
					<h5><strong>Téléphone Professionnel :</strong> {{WorkPhone}}</h5>
				</div>
                <div class="col-12">
					<h5><strong>Adresse :</strong> {{Address}}</h5>
				</div>
			</div>
        </div>
            <div *ngIf="isSelected2" class="card">
              <h3 style="color: #f1a253;"><strong>Gérant/Manager</strong></h3>
              <div *ngFor="let manager of managers; let i = index" class="grid formgrid">
                <h3 class="col-12">Manager {{ i + 1 }}</h3>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Nom - Prénom :</strong> {{ manager.ManagerLastName }} {{ manager.ManagerFirstName }}</h5>
                </div>
                <div  *ngIf="manager.Id_Identity?.key === 'A'" class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>CIN :</strong> {{ manager.CIN }}</h5>
                </div>
                <div *ngIf="manager.Id_Identity?.key === 'B'" class="col-12 mb-2 lg:col-6 lg:mb-0">
                    <h5><strong>Carte Séjour :</strong> {{ manager.CarteSejour }}</h5>
                </div>
                <div *ngIf="manager.Id_Identity?.key === 'C'" class="col-12 mb-2 lg:col-6 lg:mb-0">
                    <h5><strong>Passeport: </strong> {{ manager.Passeport }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Date de Naissance :</strong> {{ manager.ManagerBirthDate }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Civilité :</strong> {{ manager.ManagerTitleID?.label }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Nationalité :</strong> {{ manager.ManagerNationality }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Situation familiale :</strong> {{ manager.Id_ManagerMaritalStatus?.label }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Ville :</strong> {{ manager.ManagerCity }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Pays :</strong> {{ manager.ManagerCountryID?.label }}</h5>
                </div>
                <div class="col-12 mb-2 lg:col-6 lg:mb-0">
                  <h5><strong>Pays de Résidence :</strong> {{ manager.ManagerResidenceCountryID?.label }}</h5>
                </div>
                <div class="col-12">
                  <h5><strong>Adresse :</strong> {{ manager.ManagerAddress }}</h5>
                </div>
                <!-- Add a separator between managers -->
                <div *ngIf="i < managers.length - 1" class="col-12 my-3" style="border-bottom: 1px solid #ddd;"></div>
              </div>
          </div>
    </div>
</div>

<div *ngIf="step == 6" class="flex space-between mt-4" style="justify-content: space-between;">
  <button 
    pButton pRipple type="button"
    class="p-button-primary" 
    label="Done"  
    (click)="goToPreviousStep()">
  </button>
</div>

<p-dialog 
  header="Confirmation de suppression" 
  [(visible)]="displayDeleteConfirmation" 
  [style]="{width: '450px'}" 
  [modal]="true"
  [draggable]="false" 
  [resizable]="false"
  [closable]="!deleteLoading">
  
  <div class="confirmation-content">
    <i class="pi pi-exclamation-triangle p-mr-3" style="font-size: 2rem"></i>
    <span>Êtes-vous sûr de vouloir supprimer ce client ? Cette action est irréversible.</span>
  </div>
  
  <ng-template pTemplate="footer">
    <button 
      pButton 
      type="button" 
      label="Non" 
      icon="pi pi-times" 
      class="p-button-text" 
      (click)="hideDeleteConfirmation()"
      [disabled]="deleteLoading">
    </button>
    <button 
      pButton 
      type="button" 
      label="Oui" 
      icon="pi pi-check" 
      class="p-button-danger" 
      (click)="confirmDelete()"
      [disabled]="deleteLoading">
      <span *ngIf="deleteLoading" class="pi pi-spin pi-spinner" style="margin-right: 0.5rem"></span>
      <!-- <span>Oui</span> -->
    </button>
  </ng-template>
</p-dialog>

